import{r as i,k as v,o as m,c as b,w as c,P as l,p as h,a as s,b as y,d as w,e as x,f as Q,g as V,l as q,N as u}from"./app-02de39f9.js";import{Q as _}from"./QSelect-4c4a6120.js";import{Q as C}from"./QForm-b3950491.js";import{Q as k}from"./QPage-f839adb7.js";const B={key:0,class:"row q-mx-auto bg-white col-10 col-sm-8"},U={__name:"Create",setup(N){const r=i([]),n=i(!1),t=i({name:"",parent:null}),p=async()=>{l.show(),l.hide()},g=async(o,e,a)=>{if(o.length>=2){n.value=!0;try{const d=await axios.get("/api/categories",{params:{q:o}});r.value=d.data.data,e(()=>r.value)}catch{u.create({message:"Fetching categories failed",color:"red"})}n.value=!1}},f=async()=>{var o,e;l.show();try{t.value.parent_id=(o=t.value.parent)==null?void 0:o.id;const a=await axios.post("/api/categories",t.value);(e=a==null?void 0:a.data)!=null&&e.success?u.create({message:"Категория успешно создана",color:"green",timeout:2e3}):u.create({message:"Ошибка создания категории",color:"red",timeout:2e3})}catch(a){console.log(a)}l.hide()};return v(()=>{p()}),(o,e)=>(m(),b(k,{class:"row shadow-3 bg-grey-2"},{default:c(()=>[t.value?(m(),h("div",B,[s(V,{class:"bg-white q-px-xl blue col-12"},{default:c(()=>[e[2]||(e[2]=y("div",{class:"text-h4 q-mt-md"}," Создание категории ",-1)),s(C,{class:"q-mt-xl",onSubmit:w(f,["prevent"])},{default:c(()=>[s(x,{label:"Название",dense:"",outlined:"",modelValue:t.value.name,"onUpdate:modelValue":e[0]||(e[0]=a=>t.value.name=a),class:"q-mt-md"},null,8,["modelValue"]),s(_,{class:"col-3 q-mt-md",dense:"",clearable:"",outlined:"",modelValue:t.value.parent,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.parent=a),options:r.value,label:"Родительская категория","option-value":"id","option-label":"name","use-input":"","input-debounce":"300",hint:"Введите не менее 3 символов",onFilter:g,loading:n.value},null,8,["modelValue","options","loading"]),s(Q,{type:"submit",label:"Сохранить",color:"primary",class:"q-mt-md"})]),_:1})]),_:1})])):q("",!0)]),_:1}))}};export{U as default};
