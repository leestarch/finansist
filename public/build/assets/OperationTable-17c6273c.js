import{r as J,A as K,o as a,s as n,a as k,w as g,F as m,v as f,t as p,l as s,x as W,b as h,c as x,q as $,n as X,P as z,N as L}from"./app-6990ba06.js";import{a as Y,Q as Z}from"./QTable-adad826a.js";import{Q as ee}from"./QPagination-c168384d.js";/* empty css                                                                       */const ae=(c,P)=>{const v=c.__vccOpts||c;for(const[C,N]of P)v[C]=N;return v},oe={key:0,class:"shadow-3"},te={key:0},re={class:"text-primary"},ne={key:0},le={key:7},se={class:"row bg-white justify-center q-pb-md rounded-borders"},ce={key:1,class:"row q-mt-sm bg-white justify-center q-pb-md rounded-borders shadow-3"},ie={__name:"OperationTable",props:{operations:Array,pagination:Object},emits:["update:pagination","refresh"],setup(c,{emit:P}){const v=c,C=J([{name:"sber_amountRub",label:"Сумма",field:"sber_amountRub",align:"left",sortable:!0,sort:(o,t)=>parseInt(o,10)-parseInt(t,10)},{name:"categories",label:"Категория",field:"categories",align:"left",sortable:!0,sort:(o,t,r,e)=>{var i,u,y,w;const _=((u=(i=r.categories)==null?void 0:i[0])==null?void 0:u.name)||"",b=((w=(y=e.categories)==null?void 0:y[0])==null?void 0:w.name)||"";return _.localeCompare(b)}},{name:"u_contractor",label:"Юр. лицо",field:"payer_contractor",align:"left",sortable:!0,sort:(o,t,r,e)=>{var i,u;const _=((i=r.payer_contractor)==null?void 0:i.full_name)||"",b=((u=e.payer_contractor)==null?void 0:u.full_name)||"";return _.localeCompare(b)}},{name:"contractor",label:"Контрагент",field:"payee_contractor",align:"left",sortable:!0,sort:(o,t,r,e)=>{var i,u;const _=((i=r.payee_contractor)==null?void 0:i.full_name)||"",b=((u=e.payee_contractor)==null?void 0:u.full_name)||"";return _.localeCompare(b)}},{name:"is_completed",label:"is completed",field:"is_completed",align:"left",sortable:!1},{name:"is_manual",label:"is manual",field:"is_manual",align:"left",sortable:!0,sort:(o,t)=>Number(o)-Number(t)},{name:"direction",label:"Направление",field:"direction",sortable:!0},{name:"actions",label:"Действия",align:"left"},{name:"date_at",label:"Дата",field:"date_at",align:"left",sortable:!0,sort:(o,t)=>new Date(o)-new Date(t)},{name:"sber_paymentPurpose",label:"Назначение",field:"sber_paymentPurpose",align:"left"}]),N=P,G=o=>{N("update:pagination",{...v.pagination,page:o})},H=async o=>{var t;z.show();try{const r=await axios.put(`/api/operations/${o==null?void 0:o.id}`,{is_manual:o.is_manual});(t=r==null?void 0:r.data)!=null&&t.success&&L.create({message:"Обновлено",color:"green",timeout:2e3})}catch{L.create({message:"Ошибка обновления",color:"red",timeout:2e3})}z.hide()},B=o=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(o);return(o,t)=>{const r=K("router-link");return c.operations.length?(a(),n("div",oe,[k(Z,{flat:"",class:"q-mt-md q-px-sm fixed-table",rows:c.operations,pagination:{rowsPerPage:c.pagination.rowsPerPage},columns:C.value,"row-key":"id","hide-bottom":""},{"body-cell":g(e=>[k(Y,{item:e,class:"fixed-cell"},{default:g(()=>{var _,b,i,u,y,w,q,Q,R,I,O,U,A,T,j,S,D,E,F,M;return[e.col.name==="sber_amountRub"?(a(),n(m,{key:0},[f(p(B((_=e.row)==null?void 0:_.sber_amountRub)),1)],64)):s("",!0),e.col.name==="categories"?(a(),n(m,{key:1},[((b=e.row)==null?void 0:b.categories.length)>1?(a(),n("span",te,[(a(!0),n(m,null,W(e.row.categories,(l,d)=>(a(),n("span",null,[f(p(l.name)+" ",1),h("span",re," ("+p(B(l.sber_amountRub))+") ",1),d<e.row.categories.length-1?(a(),n("span",ne,", ")):s("",!0)]))),256))])):(a(),n(m,{key:1},[(y=(u=(i=e.row)==null?void 0:i.categories)==null?void 0:u[0])!=null&&y.id?(a(),x(r,{key:0,to:{name:"CategoriesEdit",params:{id:(Q=(q=(w=e.row)==null?void 0:w.categories)==null?void 0:q[0])==null?void 0:Q.id}},target:"_blank"},{default:g(()=>{var l,d;return[f(p((d=(l=e.row)==null?void 0:l.categories)==null?void 0:d.map(V=>V==null?void 0:V.name).join(", ")),1)]}),_:2},1032,["to"])):s("",!0)],64))],64)):s("",!0),e.col.name==="u_contractor"?(a(),n(m,{key:2},[(I=(R=e.row)==null?void 0:R.payer_contractor)!=null&&I.id?(a(),x(r,{key:0,to:{name:"ContractorShow",params:{id:(U=(O=e.row)==null?void 0:O.payer_contractor)==null?void 0:U.id}},target:"_blank"},{default:g(()=>{var l,d;return[h("div",null,p((d=(l=e.row)==null?void 0:l.payer_contractor)==null?void 0:d.full_name),1)]}),_:2},1032,["to"])):s("",!0)],64)):s("",!0),e.col.name==="contractor"?(a(),n(m,{key:3},[(T=(A=e.row)==null?void 0:A.payee_contractor)!=null&&T.id?(a(),x(r,{key:0,to:{name:"ContractorShow",params:{id:(S=(j=e.row)==null?void 0:j.payee_contractor)==null?void 0:S.id}},target:"_blank"},{default:g(()=>{var l,d;return[h("div",null,p((d=(l=e.row)==null?void 0:l.payee_contractor)==null?void 0:d.full_name),1)]}),_:2},1032,["to"])):s("",!0)],64)):s("",!0),e.col.name==="is_completed"?(a(),x($,{key:4,"model-value":e.row.is_completed},null,8,["model-value"])):s("",!0),e.col.name==="is_manual"?(a(),x($,{key:5,"onUpdate:modelValue":[l=>e.row.is_manual=l,l=>H(e.row)],"model-value":e.row.is_manual},null,8,["onUpdate:modelValue","model-value"])):s("",!0),e.col.name==="direction"?(a(),n(m,{key:6},[f(p((D=e.row)==null?void 0:D.direction),1)],64)):s("",!0),e.col.name==="actions"?(a(),n("div",le,[k(r,{to:{name:"OperationEdit",params:{id:(E=e==null?void 0:e.row)==null?void 0:E.id}},class:"cursor-pointer"},{default:g(()=>[k(X,{color:"primary",size:"xs",name:"edit",class:"cursor-pointer"})]),_:2},1032,["to"])])):s("",!0),e.col.name==="date_at"?(a(),n(m,{key:8},[f(p((F=e.row)==null?void 0:F.date_at),1)],64)):s("",!0),e.col.name==="sber_paymentPurpose"?(a(),n(m,{key:9},[f(p((M=e.row)==null?void 0:M.sber_paymentPurpose),1)],64)):s("",!0)]}),_:2},1032,["item"])]),_:1},8,["rows","pagination","columns"]),h("div",se,[k(ee,{modelValue:c.pagination.page,"onUpdate:modelValue":[t[0]||(t[0]=e=>c.pagination.page=e),G],max:Math.ceil(c.pagination.rowsNumber/c.pagination.rowsPerPage),"boundary-numbers":"","boundary-links":"","max-pages":10,class:"text-center q-mt-md"},null,8,["modelValue","max"])])])):(a(),n("div",ce,t[1]||(t[1]=[h("p",{class:"text-h6"}," Для этого контрагента операции не найдены ",-1)])))}}},_e=ae(ie,[["__scopeId","data-v-ffea2cae"]]);export{_e as O,ae as _};
