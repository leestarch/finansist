import{r as m,j as P,k as V,A as x,o as i,c as p,w as d,l as u,N as Q,b as c,a as t,e as f,f as w,d as q,v as b,t as v,s as N,F as C,z as B}from"./app-d946fa0e.js";import{Q as F}from"./QForm-8d1412b0.js";import{Q as U,a as j}from"./QTable-2ba8fe71.js";import{Q as z}from"./QPagination-8b1bfbc1.js";import{Q as M}from"./QPage-6926e64f.js";import"./QSelect-a72fa5e0.js";const T={class:"bg-white q-ma-sm q-pa-sm"},I={class:"row"},S={class:"row justify-end q-mt-md"},$={class:"rounded-borders bg-white shadow-3"},A={class:"row bg-white justify-center q-pb-md rounded-borders"},R={__name:"Index",setup(D){const n=m([]),_=m(!1),a=m({page:1,rowsPerPage:30,rowsNumber:0}),o=m({name:"",inn:""});P(o,()=>{a.value.page=1},{deep:!0});const g=async()=>{var s,l;try{const r=await axios.get("/api/contractors",{params:{...o.value,paginate:a.value.rowsPerPage,page:a.value.page}});n.value=r.data.data,a.value.rowsNumber=(l=(s=r.data)==null?void 0:s.meta)==null?void 0:l.total}catch{Q.create({message:"Ошибка получения данных",color:"red",timeout:2e3})}},y=[{name:"full_name",label:"Имя",field:"full_name",align:"left"},{name:"inn_kpp",label:"ИНН",field:"inn_kpp",align:"left"}],k=async s=>{a.value.page=s,await g()},h=async()=>{await g()};return V(()=>{g()}),(s,l)=>{const r=x("router-link");return n.value?(i(),p(M,{key:0,class:"bg-grey-2"},{default:d(()=>[c("div",T,[t(F,{onSubmit:q(h,["prevent"]),class:"items-center q-pa-md bg-grey-2 rounded-borders"},{default:d(()=>[c("div",I,[t(f,{class:"col-3",clearable:"",dense:"",outlined:"",filled:"",modelValue:o.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>o.value.name=e),label:"Имя"},null,8,["modelValue"]),t(f,{class:"col-3 q-ml-lg",dense:"",clearable:"",outlined:"",filled:"",modelValue:o.value.inn,"onUpdate:modelValue":l[1]||(l[1]=e=>o.value.inn=e),label:"ИНН"},null,8,["modelValue"])]),c("div",S,[t(w,{class:"text-right",dense:"",size:"sm",type:"submit",label:"Применить фильтры",color:"green"})])]),_:1}),c("div",$,[n.value.length?(i(),p(U,{key:0,class:"q-mt-md q-mx-sm",rows:n.value,columns:y,"row-key":"id",pagination:{rowsPerPage:a.value.rowsPerPage},"hide-bottom":"",flat:"",loading:!n.value.length},{"body-cell":d(e=>[t(j,{class:B(e.row.is_wrong?"bg-red-2":e.row.is_validated?"bg-green-2":""),item:e},{default:d(()=>[e.col.name=="full_name"?(i(),p(r,{key:0,to:`/contractors/${e.row.id}`},{default:d(()=>[b(v(e.row.full_name),1)]),_:2},1032,["to"])):u("",!0),e.col.name=="inn_kpp"?(i(),N(C,{key:1},[b(v(e.row.inn_kpp),1)],64)):u("",!0),e.col.name=="actions"?(i(),p(w,{key:2,dense:"",flat:"",color:"primary",label:"Проверить",onClick:E=>s.checkContractorsOperation(e.row.id),loading:_.value},null,8,["onClick","loading"])):u("",!0)]),_:2},1032,["class","item"])]),_:1},8,["rows","pagination","loading"])):u("",!0),c("div",A,[t(z,{modelValue:a.value.page,"onUpdate:modelValue":[l[2]||(l[2]=e=>a.value.page=e),k],max:Math.ceil(a.value.rowsNumber/a.value.rowsPerPage),"boundary-numbers":"","boundary-links":"","max-pages":10,class:"text-center q-mt-md"},null,8,["modelValue","max"])])])])]),_:1})):u("",!0)}}};export{R as default};
