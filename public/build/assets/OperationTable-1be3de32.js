import{r as z,A as L,o as a,s as n,a as w,w as k,F as d,v as g,t as m,l as s,x as G,b as x,c as v,q as E,n as H,P as F,N as S}from"./app-e2b673e7.js";import{a as J,Q as K}from"./QTable-66bad645.js";import{Q as W}from"./QPagination-159fe69e.js";/* empty css                                                                       */const X=(l,P)=>{const h=l.__vccOpts||l;for(const[N,C]of P)h[N]=C;return h},Y={key:0,class:"shadow-3"},Z={key:0},ee={class:"text-primary"},ae={key:0},te={key:6},oe={class:"row bg-white justify-center q-pb-md rounded-borders"},ne={key:1,class:"row q-mt-sm bg-white justify-center q-pb-md rounded-borders shadow-3"},re={__name:"OperationTable",props:{operations:Array,pagination:Object},emits:["update:pagination","refresh"],setup(l,{emit:P}){const h=l,N=z([{name:"sber_amountRub",label:"Сумма",field:"sber_amountRub",align:"left",sortable:!0,sort:(t,o)=>parseInt(t,10)-parseInt(o,10)},{name:"categories",label:"Категория",field:"categories",align:"left",sortable:!0,sort:(t,o,r,e)=>{var c,u,f,y;const b=((u=(c=r.categories)==null?void 0:c[0])==null?void 0:u.name)||"",_=((y=(f=e.categories)==null?void 0:f[0])==null?void 0:y.name)||"";return b.localeCompare(_)}},{name:"contractor",label:"Контрагент",field:"payee_contractor",align:"left",sortable:!0,sort:(t,o,r,e)=>{var c,u;const b=((c=r.payee_contractor)==null?void 0:c.full_name)||"",_=((u=e.payee_contractor)==null?void 0:u.full_name)||"";return b.localeCompare(_)}},{name:"is_completed",label:"is completed",field:"is_completed",align:"left",sortable:!1},{name:"is_manual",label:"is manual",field:"is_manual",align:"left",sortable:!0,sort:(t,o)=>Number(t)-Number(o)},{name:"direction",label:"Направление",field:"direction",sortable:!0},{name:"actions",label:"Действия",align:"left"},{name:"date_at",label:"Дата",field:"date_at",align:"left",sortable:!0,sort:(t,o)=>new Date(t)-new Date(o)},{name:"sber_paymentPurpose",label:"Назначение",field:"sber_paymentPurpose",align:"left"}]),C=P,M=t=>{C("update:pagination",{...h.pagination,page:t})},$=async t=>{var o;F.show();try{const r=await axios.put(`/api/operations/${t==null?void 0:t.id}`,{is_manual:t.is_manual});(o=r==null?void 0:r.data)!=null&&o.success&&S.create({message:"Обновлено",color:"green",timeout:2e3})}catch{S.create({message:"Ошибка обновления",color:"red",timeout:2e3})}F.hide()},q=t=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(t);return(t,o)=>{const r=L("router-link");return l.operations.length?(a(),n("div",Y,[w(K,{flat:"",class:"q-mt-md q-px-sm fixed-table",rows:l.operations,pagination:{rowsPerPage:l.pagination.rowsPerPage},columns:N.value,"row-key":"id","hide-bottom":""},{"body-cell":k(e=>[w(J,{item:e,class:"fixed-cell"},{default:k(()=>{var b,_,c,u,f,y,B,Q,R,I,O,U,T,j,A,D;return[e.col.name==="sber_amountRub"?(a(),n(d,{key:0},[g(m(q((b=e.row)==null?void 0:b.sber_amountRub)),1)],64)):s("",!0),e.col.name==="categories"?(a(),n(d,{key:1},[((_=e.row)==null?void 0:_.categories.length)>1?(a(),n("span",Z,[(a(!0),n(d,null,G(e.row.categories,(i,p)=>(a(),n("span",null,[g(m(i.name)+" ",1),x("span",ee," ("+m(q(i.sber_amountRub))+") ",1),p<e.row.categories.length-1?(a(),n("span",ae,", ")):s("",!0)]))),256))])):(a(),n(d,{key:1},[(f=(u=(c=e.row)==null?void 0:c.categories)==null?void 0:u[0])!=null&&f.id?(a(),v(r,{key:0,to:{name:"CategoriesEdit",params:{id:(Q=(B=(y=e.row)==null?void 0:y.categories)==null?void 0:B[0])==null?void 0:Q.id}},target:"_blank"},{default:k(()=>{var i,p;return[g(m((p=(i=e.row)==null?void 0:i.categories)==null?void 0:p.map(V=>V==null?void 0:V.name).join(", ")),1)]}),_:2},1032,["to"])):s("",!0)],64))],64)):s("",!0),e.col.name==="contractor"?(a(),n(d,{key:2},[(I=(R=e.row)==null?void 0:R.payee_contractor)!=null&&I.id?(a(),v(r,{key:0,to:{name:"ContractorShow",params:{id:(U=(O=e.row)==null?void 0:O.payee_contractor)==null?void 0:U.id}},target:"_blank"},{default:k(()=>{var i,p;return[x("div",null,m((p=(i=e.row)==null?void 0:i.payee_contractor)==null?void 0:p.full_name),1)]}),_:2},1032,["to"])):s("",!0)],64)):s("",!0),e.col.name==="is_completed"?(a(),v(E,{key:3,"model-value":e.row.is_completed},null,8,["model-value"])):s("",!0),e.col.name==="is_manual"?(a(),v(E,{key:4,"onUpdate:modelValue":[i=>e.row.is_manual=i,i=>$(e.row)],"model-value":e.row.is_manual},null,8,["onUpdate:modelValue","model-value"])):s("",!0),e.col.name==="direction"?(a(),n(d,{key:5},[g(m((T=e.row)==null?void 0:T.direction),1)],64)):s("",!0),e.col.name==="actions"?(a(),n("div",te,[w(r,{to:{name:"OperationEdit",params:{id:(j=e==null?void 0:e.row)==null?void 0:j.id}},class:"cursor-pointer"},{default:k(()=>[w(H,{color:"primary",size:"xs",name:"edit",class:"cursor-pointer"})]),_:2},1032,["to"])])):s("",!0),e.col.name==="date_at"?(a(),n(d,{key:7},[g(m((A=e.row)==null?void 0:A.date_at),1)],64)):s("",!0),e.col.name==="sber_paymentPurpose"?(a(),n(d,{key:8},[g(m((D=e.row)==null?void 0:D.sber_paymentPurpose),1)],64)):s("",!0)]}),_:2},1032,["item"])]),_:1},8,["rows","pagination","columns"]),x("div",oe,[w(W,{modelValue:l.pagination.page,"onUpdate:modelValue":[o[0]||(o[0]=e=>l.pagination.page=e),M],max:Math.ceil(l.pagination.rowsNumber/l.pagination.rowsPerPage),"boundary-numbers":"","boundary-links":"","max-pages":10,class:"text-center q-mt-md"},null,8,["modelValue","max"])])])):(a(),n("div",ne,o[1]||(o[1]=[x("p",{class:"text-h6"}," Для этого контрагента операции не найдены ",-1)])))}}},ue=X(re,[["__scopeId","data-v-378adf29"]]);export{ue as O,X as _};
